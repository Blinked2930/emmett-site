---
import Layout from '../layouts/Layout.astro';

// This single line automates your entire publishing system. 
// It fetches every Markdown file inside the essays folder.
const allEssays = await Astro.glob('./essays/*.md');
---

<Layout title="Essays | Emmett Frett">
  <main class="min-h-screen bg-zinc-50 max-w-5xl mx-auto px-6 py-20">
    <a href="/" class="text-zinc-500 hover:text-zinc-900 transition-colors duration-300 font-['Inter'] text-sm tracking-widest uppercase mb-16 inline-flex items-center gap-2 font-bold">
      &larr; Back to Home
    </a>

    <header class="mb-20 max-w-2xl glide">
      <h1 class="font-['Montserrat'] font-black text-5xl md:text-6xl text-zinc-900 mb-6 tracking-tight">
        Essays
      </h1>
      <p class="font-['Inter'] text-zinc-500 text-lg md:text-xl leading-relaxed font-light">
        Life is best understood through the friction it provides. These are stories from my lifeâ€”crafted to be unapologetic, genuine, and focused on the lessons learned in the pursuit of courageous authenticity.
      </p>
    </header>

    <div class="flex flex-col gap-10">
      {/* We map over the fetched files and use 'index' to stagger the reveal */}
      {allEssays.map((essay, index) => (
        <a 
          href={essay.url} 
          class="glide group block bg-white border border-zinc-200 rounded-xl overflow-hidden flex flex-col md:flex-row shadow-sm hover:shadow-md transition-shadow"
          style={`transition-delay: ${index * 0.15}s;`}
        >
          
          <div class="w-full md:w-2/5 h-64 md:h-auto overflow-hidden relative">
            {/* The Mathematical Bridge for a smooth, calculated reveal */}
            <img 
              src={essay.frontmatter.image} 
              alt={essay.frontmatter.title} 
              class="w-full h-full object-cover scale-100 grayscale contrast-100 brightness-100 group-hover:scale-105 group-hover:grayscale-0 group-hover:contrast-105 group-hover:brightness-105 transition-all duration-[1500ms] ease-out" 
            />
          </div>

          <div class="w-full md:w-3/5 p-8 md:p-12 flex flex-col justify-center">
            <time class="font-['Inter'] text-xs font-bold tracking-widest text-zinc-400 uppercase mb-4 block">
              {essay.frontmatter.date}
            </time>
            <h2 class="font-['Montserrat'] font-bold text-2xl md:text-3xl text-zinc-900 mb-4">
              {essay.frontmatter.title}
            </h2>
            <p class="font-['Inter'] text-zinc-600 leading-relaxed text-base md:text-lg mb-8">
              {essay.frontmatter.excerpt}
            </p>
            {/* Replaced 'Drafting in Progress' with an interactive button */}
            <div class="font-['Inter'] text-xs font-bold tracking-[0.2em] text-zinc-400 uppercase mt-auto border border-zinc-200 inline-block px-4 py-2 rounded-sm self-start group-hover:bg-zinc-900 group-hover:text-white transition-colors duration-300">
              Read Essay &rarr;
            </div>
          </div>
          
        </a>
      ))}
    </div>
  </main>
</Layout>