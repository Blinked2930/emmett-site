---
import Layout from '../layouts/Layout.astro';

// We'll use your two folded note photos as "Process" images
const processImages = [
  '/love-notes/folded-1.jpeg',
  '/love-notes/folded-2.jpeg'
];
---

<Layout title="From A Stranger | Emmett Frett">
  <main class="min-h-screen bg-zinc-50 max-w-7xl mx-auto px-6 py-20">
    <a href="/" class="text-zinc-500 hover:text-zinc-900 transition-colors duration-300 font-['Inter'] text-sm tracking-wider uppercase mb-16 inline-flex items-center gap-2 font-bold">
      &larr; Back to Home
    </a>

    <header class="mb-20 max-w-3xl glide">
      <h1 class="font-['Montserrat'] font-extrabold text-5xl md:text-6xl text-zinc-900 mb-6">
        From A Stranger
      </h1>
      <p class="font-['Inter'] text-zinc-500 text-lg leading-relaxed font-light mb-12">
        In an era of passive consumption, I leave 30-word handwritten messages in the places I travel. No context, no agendaâ€”just a brief intersection of two lives.
      </p>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-8 py-10 border-y border-zinc-200">
        <div>
          <span class="block font-['Montserrat'] font-bold text-3xl text-zinc-900">226</span>
          <span class="font-['Inter'] text-xs uppercase tracking-widest text-zinc-400 font-bold">Total Notes</span>
        </div>
        <div>
          <span class="block font-['Montserrat'] font-bold text-3xl text-zinc-900">1,582</span>
          <span class="font-['Inter'] text-xs uppercase tracking-widest text-zinc-400 font-bold">Minutes Spent</span>
        </div>
        <div>
          <span class="block font-['Montserrat'] font-bold text-3xl text-zinc-900">~26</span>
          <span class="font-['Inter'] text-xs uppercase tracking-widest text-zinc-400 font-bold">Hours of Creating</span>
        </div>
      </div>
    </header>

    <section class="mb-32">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {processImages.map((img) => (
          <div class="glide aspect-video overflow-hidden rounded-sm bg-zinc-200 grayscale contrast-125">
             <img 
               src={img} 
               alt="Handwritten notes folded and ready to be left" 
               class="w-full h-full object-cover opacity-90"
             />
          </div>
        ))}
      </div>
      <p class="mt-6 font-['Inter'] text-zinc-400 text-sm italic text-center">
        Every note is folded by hand, ensuring everyone feels the simplicity of love.
      </p>
    </section>

    <div id="notes-grid" class="grid grid-cols-1 md:grid-cols-2 gap-16">
      </div>

    <div class="mt-24 text-center glide">
      <button 
        onclick="window.location.reload()" 
        class="px-8 py-4 bg-white border border-zinc-200 text-zinc-500 hover:text-zinc-900 hover:border-zinc-900 transition-all duration-300 rounded-sm font-['Inter'] text-xs font-bold tracking-[0.3em] uppercase"
      >
        See Some New Notes
      </button>
    </div>
  </main>
</Layout>

<script is:inline>
  function renderRandomNotes() {
    const TOTAL_NOTES = 226; 
    const DISPLAY_COUNT = 8; 
    const grid = document.getElementById('notes-grid');
    
    const indices = Array.from({ length: TOTAL_NOTES }, (_, i) => i + 1);
    
    for (let i = indices.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [indices[i], indices[j]] = [indices[j], indices[i]];
    }
    
    const selected = indices.slice(0, DISPLAY_COUNT);
    
    selected.forEach((num, index) => {
      const wrapper = document.createElement('div');
      wrapper.className = 'glide aspect-[4/3] overflow-hidden bg-white rounded-sm border border-zinc-200 shadow-sm group';
      wrapper.style.transitionDelay = `${index * 0.1}s`;
      
      // --- THE MATHEMATICAL BRIDGE FIX IS HERE ---
      wrapper.innerHTML = `
        <img 
          src="/love-notes/${num}.jpeg" 
          alt="Handwritten note #${num}" 
          class="w-full h-full object-contain bg-zinc-100 opacity-80 grayscale contrast-125 brightness-100 group-hover:opacity-100 group-hover:grayscale-0 group-hover:contrast-100 group-hover:brightness-110 transition-all duration-[1000ms] ease-out cursor-pointer"
          loading="lazy"
        />
      `;
      // ----------------------------------------
      grid.appendChild(wrapper);
    });

    if (window.IntersectionObserver) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('glide-in');
          }
        });
      }, { threshold: 0.1 });

      document.querySelectorAll('.glide').forEach((el) => observer.observe(el));
    }
  }

  document.addEventListener('DOMContentLoaded', renderRandomNotes);
</script>